<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Potato Smacker</title>
  <link rel="icon" href="https://raw.githubusercontent.com/shashwat-r-weblab/shashwat-r-weblab.github.io/refs/heads/main/potato-smacker/potato-icon64.png" type="image/png">
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: #ffffff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      user-select: none;
      -webkit-user-select: none;
      touch-action: manipulation;
    }

    h1 {
      margin-bottom: 20px;
    }

    .rock-container {
      position: relative;
      display: inline-block;
      cursor: pointer;
      transition: transform 0.05s ease;
    }

    .rock {
      width: 350px;
      height: 350px;
      background-image: url('https://raw.githubusercontent.com/shashwat-r-weblab/shashwat-r-weblab.github.io/refs/heads/main/potato-smacker/potato.png');
      background-size: cover;
      background-position: center;
      /* border-radius: 90%; */
      touch-action: manipulation;
    }

    .counter {
      margin-top: 10px;
      font-size: 1.5rem;
      color: #887766;
      text-align: center;
    }

    .link-list {
      margin-top: 20px;
      list-style: none;
      padding: 0;
    }

    .link-list li {
      margin: 5px 0;
    }

    .link-list a {
      color: #887766;
      text-decoration: none;
    }

    .link-list a:hover {
      text-decoration: underline;
    }
  </style>
</head>
<body>
  <h1>Don't Smack the Potato</h1>
  <div class="counter" id="counter">Despite how Smackable it looks!</div>

  <div class="rock-container" id="potato">
    <div class="rock"></div>
  </div>

  <ul class="link-list">
    <li><i><a href="#">"don't fall for it's smackalicious crunchiness"</a></i></li>
  </ul>

  <audio id="smackSound" src="https://github.com/shashwat-r-weblab/shashwat-r-weblab.github.io/raw/refs/heads/main/potato-smacker/smack.mp3"></audio>
  <audio id="dingSound" src="https://github.com/shashwat-r-weblab/shashwat-r-weblab.github.io/raw/refs/heads/main/potato-smacker/ding.mp3"></audio>

  <script>
    let counter = 0;
    let previous_integral_part = 0;
    let dialogue_prefix_text = "";
    let prefix_text_list_history = [];
    let rotationDirection = 1; // alternates +1 / -1
    const potato = document.getElementById("potato");

    // Unified input listener for both click and tap
    function addUnifiedInputListener(element, callback) {
      let touchHandled = false;

      element.addEventListener("touchstart", e => {
        if (!touchHandled) {
          touchHandled = true;
          callback(e);
          setTimeout(() => touchHandled = false, 300);
        }
      }, { passive: true });

      element.addEventListener("click", e => {
        if (!touchHandled) callback(e);
      });
    }

    addUnifiedInputListener(potato, incrementCounter);

    function incrementCounter() {
      counter++;
      let counter_text = "You Smacked the Potato " + counter + " times!";
      if (counter === 1) counter_text = "You Smacked the Potato!";

      const prefix_text_list = [
        "My Goodness! ",
        "Are you still at this? ",
        "Holy Cow! ",
        "You know you can stop right? ",
        "Unbelievable! ",
        "Seriously? Still?? ",
        "Goddamnit! ",
        "This is a violation! ",
        "Is this a cry for help? ",
        "Why? ",
        "You're really committed to this, huh? ",
        "I have no words anymore. ",
        "Somebody call a therapist! ",
        "This has gone too far! ",
        "Who hurt you? ",
        "Blink twice if you need help! ",
        "I wonder who the real Potato is! ",
        "Your dedication is... disturbing! ",
        "Stop it! Get some help. ",
        "Therapy is always an option, you know? ",
        "Don't you have a hobby? ",
        "Oh great, now the FBI is watching. ",
        "This is not how you win friends and influence people. ",
        "The Potato is reconsidering its existence. ",
        "If stupidity were an Olympic sport, you'd be the coach. ",
        "Please explain this to your future self. ",
        "You are one screen refresh away from wiping your progress. ",
        "The Potato is filing a grievance. ",
        "The Potato didn't consent to this. ",
        "This would be impressive if it wasn't concerning. ",
        "What would your ancestors say? ",
      ];

      const current_integral_part = Math.floor(counter / 25);
      if (current_integral_part !== previous_integral_part) {
        previous_integral_part = current_integral_part;

        while (true) {
          dialogue_prefix_text = prefix_text_list[Math.floor(Math.random() * prefix_text_list.length)];
          if (prefix_text_list_history.length === 0) break;
          let is_dialogue_old = prefix_text_list_history.includes(dialogue_prefix_text);
          if (!is_dialogue_old) break;
        }

        prefix_text_list_history.push(dialogue_prefix_text);
        if (prefix_text_list_history.length > 5) prefix_text_list_history.shift();

        playDingSound();
      }

      document.getElementById('counter').textContent = dialogue_prefix_text + counter_text;
      playSmackSound();
      animatePotato();
    }

    function playSmackSound() {
      const audio = document.getElementById('smackSound');
      audio.currentTime = 0;
      audio.play();
    }

    function playDingSound() {
      const audio = document.getElementById('dingSound');
      audio.currentTime = 0;
      audio.play();
    }

    function animatePotato() {
      const rock = document.querySelector('.rock-container');

      // Alternate rotation: +5° / -5° each smack
      rotationDirection *= -1;
      const rotation = rotationDirection * 5;

      rock.style.transition = 'transform 0.05s ease';
      rock.style.transform = `scale(1.1) rotate(${rotation}deg)`;

      setTimeout(() => {
        rock.style.transform = `scale(1.0) rotate(0deg)`;
      }, 150);
    }
  </script>
</body>
</html>
